steps:
  STG_ORDERS_LINEITEM_DIM_LOOKUP-d00c7178-d3d5-4453-ab31-1f11bb69c0da:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 431fa57e-e613-4512-9c06-d104ba63c154
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 509942ae-d2c1-4ac8-ac3d-47b6bce0d2da
                    stepCounter: 73dbe6c2-a59a-47a9-8f3a-24211b1746b5
                transform: ""
          - columnReference:
              columnCounter: a43ac358-fe28-49fc-8525-5e0337c0a3d8
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 92b9c930-8b74-430e-9db3-52061e6737a8
                    stepCounter: 9e1fd35a-52f3-4b86-b199-0abc30975468
                transform: ""
          - columnReference:
              columnCounter: e908dacf-15d1-4cde-884f-8398c46abdab
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 84cdf3c5-9709-4a08-b64b-b7c7b8b70034
                    stepCounter: a85b43ca-52c4-4d93-8b52-bd975275cd2b
                transform: ""
          - columnReference:
              columnCounter: 0a15954a-3fdc-44f3-a350-77cb0dba9c7d
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f1fbd197-bb9f-4487-917e-3df82b33c383
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: 24170d01-2e28-4e3f-a587-f1d4a6446896
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a409f82d-bf1b-42f8-823e-d29a5f46513a
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: 082b1d60-1817-4835-8e2e-2d98d3b30e93
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 98e0146c-4bd5-4894-bb4f-e7cdfc4a9d15
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: 1e4dbd1b-a025-4156-8461-8f0481799693
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 703dabb5-993b-4136-bcd6-2d95618e5d63
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: 92a017a8-fe39-4951-bfb4-2cb2e3c95a3d
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7dc60345-737e-4b65-a0c0-42bd0842c7a6
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: b8794d91-ba7d-4712-962b-6ac0aaee2ed5
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 00e11a9d-139f-4fdc-b778-688a480d0c60
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: 08fc3171-e745-418d-89d4-d429cdcce586
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f2107a9a-9926-4a82-ae52-dba3903bd256
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: 4f66d778-6937-4534-8df6-98b9889b9a62
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 766c022f-806c-459f-bba9-6b17273b0296
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: c954d111-ed1d-4bab-9746-9eab131220dd
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0edbea2f-cd9d-4263-a803-72a48acf4d36
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: 20f003f6-4c51-4dc2-b210-f318d8440e4b
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: fe835724-0a16-464d-9346-47b42dec4ddb
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: d73affb0-b722-4eb2-8cb7-a3e1156faebc
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 47017110-ca9f-4212-9189-f030bf237f9d
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: 4aac7c8f-10cc-4e5c-9af9-dd904e2807f6
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 432a88dd-327d-49a8-bc75-d84ffd335cf7
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: 25ac2596-2c95-4cb3-ad46-8ba30d7ed3c7
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 412b5fae-ee5f-4b0b-a985-a0545e56d844
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: 9f4c7af1-2635-4665-b584-9f9ef026a75b
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d1b239b6-fcf8-44d4-93fc-ffbefcf62330
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: 432ace9b-3257-46c5-bc3b-2755af1030c3
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 02d25fb2-dc6e-4619-a6f5-9724ae198529
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: 42613e6f-d28c-41da-81e1-2d9af6a2dbf7
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cefeb32d-3dbd-41bf-b91d-db97f723b816
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: 83cfc763-3a13-477e-9f6c-f8a201e0e29c
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3aabcd08-5b32-4b82-87e2-b97abb68aaf2
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: ab914b14-44ec-4339-bcb2-c191b8a43afe
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a4e4f74e-3afa-4261-b22b-cc39b0c5ca94
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: d01a247b-30d9-4e45-bbea-81682e52b802
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 515d4da2-f364-4b4b-9fc3-f531d92df564
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: af0a31eb-2d63-4497-8828-0540ecd0daaa
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dc1c2d2c-8192-497f-9bef-ddba8a2acbd1
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: e83fb127-47e9-49b1-ae22-50c760f28688
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e4766a7f-4c33-4892-a65f-720b6b1861d8
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: 49f9e8ca-4978-46a8-ba75-948fb2da1061
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ce930d5a-9908-4a8f-ac0a-df0335048315
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: d464ecb8-bffa-41a8-973f-ef4ec7eb3081
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7b14bd13-681b-474e-bab6-3a59288aac4e
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: 99b88595-e37d-4610-adda-97c5ed2541c8
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0f508c69-f83b-4557-a9c6-39f72f579f01
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: ebc6190e-f16d-40b5-86d7-b6f085a43b96
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4c750529-6abf-4251-b4ce-295832a368c1
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: b1b13335-ee1e-4c50-a86a-50c62b1f04e7
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2e811eaf-bc96-40ba-b33f-1a7991077f57
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - columnReference:
              columnCounter: d287e2e3-5898-4463-b3dc-7ab6797dc3a2
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS TO SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f704c2e8-06c6-476b-9816-35a437da3a5f
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: e22fe622-d02b-4b51-a1d5-ae7f92b2ba5e
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0faae35c-0b7b-424f-b125-15222efb44fd
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: b45cdbca-f8c1-48a6-a683-b7b356255380
              stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f36a3927-959d-4c67-878d-4a3f0cb9337e
                    stepCounter: 0fbb271e-63fa-4745-a4cf-795497faf024
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 73dbe6c2-a59a-47a9-8f3a-24211b1746b5
              DIM_PART: 9e1fd35a-52f3-4b86-b199-0abc30975468
              DIM_SUPPLIER: a85b43ca-52c4-4d93-8b52-bd975275cd2b
              STG_ORDERS_LINEITEM: 0fbb271e-63fa-4745-a4cf-795497faf024
              STG_PARTSUPP: 943c7473-d00a-4071-8070-e5328dac1956
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_ORDERS_LINEITEM
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_ORDERS_LINEITEM') }} "STG_ORDERS_LINEITEM"

                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"

                ON "STG_ORDERS_LINEITEM"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"

                AND "STG_ORDERS_LINEITEM"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"

                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */

                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"

                ON "STG_ORDERS_LINEITEM"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"

                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"

                ON "STG_ORDERS_LINEITEM"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"

                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"

                ON "STG_ORDERS_LINEITEM"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND

                "STG_ORDERS_LINEITEM"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_ORDERS_LINEITEM_DIM_LOOKUP
            noLinkRefs: []
      name: STG_ORDERS_LINEITEM_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: d00c7178-d3d5-4453-ab31-1f11bb69c0da
